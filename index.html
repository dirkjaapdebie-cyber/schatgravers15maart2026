<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Schatgravers - Olijfberg Experience</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: manipulation; }
        body { font-family: 'Fredoka', sans-serif; background: #0a3d62; min-height: 100vh; display: flex; justify-content: center; padding: 10px; }
        #app { width: 100%; max-width: 450px; position: relative; }
        .screen { display: none; background: white; border-radius: 30px; padding: 20px; min-height: 85vh; box-shadow: 0 20px 40px rgba(0,0,0,0.4); flex-direction: column; }
        .screen.active { display: flex; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        #nav-bar { background: #1e3799; color: white; padding: 12px; border-radius: 50px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; gap: 10px; }
        .nav-btn { background: #f6b93b; border: none; padding: 10px 20px; border-radius: 30px; font-weight: bold; cursor: pointer; color: #1e3799; }
        #reset-btn { background: #e55039; color: white; }
        
        h2 { color: #1e3799; margin-bottom: 15px; text-align: center; }
        .story-box { background: #fdf6e3; padding: 20px; border-radius: 20px; border-left: 8px solid #f6b93b; max-height: 450px; overflow-y: auto; }
        
        /* Rad van Fortuin */
        .wheel-wrapper { position: relative; width: 260px; height: 260px; margin: 10px auto; }
        #wheel { width: 100%; height: 100%; border-radius: 50%; border: 5px solid #333; transition: transform 3s cubic-bezier(0.1, 0, 0.2, 1); background: conic-gradient(#f6b93b 0 60deg, #1e3799 60deg 120deg, #20bf6b 120deg 180deg, #e55039 180deg 240deg, #fa983a 240deg 300deg, #b71540 300deg 360deg); }
        #pointer { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); font-size: 30px; z-index: 10; }

        /* Woordveld & Doolhof */
        .word-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        .letter-tile { background: #1e3799; color: white; padding: 15px; border-radius: 10px; text-align: center; font-weight: bold; cursor: pointer; }
        .letter-tile.selected { background: #f6b93b; }
        #mazeCanvas { background: #2d5a27; border: 4px solid #8B4513; width: 100%; height: 300px; border-radius: 15px; }
        
        .btn { background: #1e3799; color: white; border: none; padding: 12px; border-radius: 50px; width: 100%; font-weight: bold; margin: 10px 0; cursor: pointer; }
        .stelling-card { display: none; background: #f8f9fa; padding: 15px; border-radius: 15px; border: 2px solid #1e3799; margin-top: 10px; }
        .stelling-card.active { display: block; }
        input, textarea { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ccc; margin: 5px 0; }
    </style>
</head>
<body>

<div id="app">
    <div id="nav-bar">
        <span id="screen-title">Inloggen</span>
        <div style="display:flex; gap:5px;">
            <button class="nav-btn" id="reset-btn" onclick="resetAllData()">üîÑ</button>
            <button class="nav-btn" onclick="nextScreen()">‚ûî</button>
        </div>
    </div>

    <div id="screen1" class="screen active">
        <h2>üëã Welkom!</h2>
        <input type="text" id="playerName" placeholder="Jouw naam...">
        <button class="btn" onclick="login()">Start Avontuur</button>
        <div id="liveNames" style="margin-top:20px;"></div>
    </div>

    <div id="screen2" class="screen">
        <h2>üèîÔ∏è De Olijfberg</h2>
        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3392.235!2d35.244!3d31.778!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x1503299778000001%3A0x6a0f6a0f6a0f6a0f!2sMount%20of%20Olives!5e0!3m2!1snl!2snl!4v1" width="100%" height="300" style="border:0; border-radius:15px;"></iframe>
    </div>

    <div id="screen3" class="screen">
        <h2>üìñ Het verhaal</h2>
        <div class="story-box">
            <h3>Jezus bidt op de Olijfberg</h3>
            <p>Jezus ging met zijn leerlingen naar de Olijfberg... [Tekst zoals aangeleverd]</p>
            <h3>Judas verraadt Jezus</h3>
            <p>Terwijl Hij nog sprak, kwam er een menigte... [Tekst zoals aangeleverd]</p>
        </div>
    </div>

    <div id="screen4" class="screen">
        <h2>üé° Rad van Fortuin</h2>
        <div class="wheel-wrapper">
            <div id="wheel"></div>
            <div id="pointer">‚ñº</div>
        </div>
        <button class="btn" onclick="spinWheel()">üé≤ Draaien!</button>
        <div id="stellingenContainer"></div>
    </div>

    <div id="screen5" class="screen">
        <h2>üôè Gebeden Match</h2>
        <div id="dragDropArea" style="display:flex; gap:10px;">
            <div id="figuurCol" style="flex:1;"></div>
            <div id="gebedCol" style="flex:1;"></div>
        </div>
    </div>

    <div id="screen6" class="screen">
        <h2>üî§ Woordzoeker</h2>
        <div id="targetDisplay" style="font-size:1.5rem; text-align:center; margin:10px;"></div>
        <div class="word-grid" id="letterGrid"></div>
        <button class="btn" onclick="checkWord()">Controleer</button>
    </div>

    <div id="screen7" class="screen">
        <h2>üèÉ Doolhof</h2>
        <canvas id="mazeCanvas" width="400" height="300"></canvas>
        <div style="display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; width:150px; margin: 10px auto;">
            <span></span><button class="btn" onclick="moveDisciple(0,-1)">‚Üë</button><span></span>
            <button class="btn" onclick="moveDisciple(-1,0)">‚Üê</button><button class="btn" onclick="moveDisciple(0,1)">‚Üì</button><button class="btn" onclick="moveDisciple(1,0)">‚Üí</button>
        </div>
    </div>
</div>

<script>
    // --- CONFIG ---
    const firebaseConfig = {
        apiKey: "AIzaSyBC3Dzm8PNPXw12VJNimvly5u2I93QeW54",
        databaseURL: "https://schatgravers15maart2026-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "schatgravers15maart2026"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let currentScreen = 1;
    let currentUser = "";
    let pPos = { x: 20, y: 20 };
    const stellingen = ["Ik ben nooit bang.", "Ik hoop dat het niet doorgaat.", "Ik help anderen.", "Ik ga bidden.", "Kracht van God.", "Meer weten over God."];

    // --- NAVIGATIE ---
    window.nextScreen = function() {
        document.getElementById(`screen${currentScreen}`).classList.remove('active');
        currentScreen = currentScreen < 7 ? currentScreen + 1 : 1;
        document.getElementById(`screen${currentScreen}`).classList.add('active');
        if(currentScreen === 4) initStellingen();
        if(currentScreen === 6) initWordGame();
        if(currentScreen === 7) initMaze();
    };

    window.login = function() {
        const name = document.getElementById('playerName').value;
        if(name) { currentUser = name; db.ref('spelers').push({naam: name}); nextScreen(); }
    };

    // --- RAD ---
    window.spinWheel = function() {
        const wheel = document.getElementById('wheel');
        const rand = Math.floor(Math.random() * 360) + 1440;
        wheel.style.transform = `rotate(${rand}deg)`;
        setTimeout(() => {
            const id = Math.floor(((rand % 360) / 60)) + 1;
            document.querySelectorAll('.stelling-card').forEach(c => c.classList.remove('active'));
            document.getElementById(`stelling${id}`).classList.add('active');
        }, 3000);
    };

    function initStellingen() {
        const cont = document.getElementById('stellingenContainer');
        cont.innerHTML = stellingen.map((s, i) => `
            <div id="stelling${i+1}" class="stelling-card">
                <p>${s}</p>
                <textarea id="ans${i+1}"></textarea>
                <button class="btn" onclick="saveAnswer(${i+1})">Stuur</button>
            </div>
        `).join('');
    }

    window.saveAnswer = function(id) {
        const val = document.getElementById(`ans${id}`).value;
        db.ref(`antwoorden/stelling${id}`).push({naam: currentUser, tekst: val});
        alert("Opgeslagen!");
    };

    // --- WOORDZOEKER ---
    let target = "JEZUS";
    window.initWordGame = function() {
        const grid = document.getElementById('letterGrid');
        grid.innerHTML = '';
        "JEZUSOLIJFBERGG".split('').sort(() => Math.random()-0.5).forEach(l => {
            const d = document.createElement('div');
            d.className = 'letter-tile'; d.innerText = l;
            d.onclick = () => d.classList.toggle('selected');
            grid.appendChild(d);
        });
    };

    // --- DOOLHOF ---
    function initMaze() {
        const canvas = document.getElementById('mazeCanvas');
        const ctx = canvas.getContext('2d');
        function draw() {
            ctx.clearRect(0,0,400,300);
            ctx.fillStyle = "blue"; ctx.beginPath(); ctx.arc(pPos.x, pPos.y, 10, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = "gold"; ctx.fillText("üôè Jezus", 350, 280);
            requestAnimationFrame(draw);
        }
        draw();
    }

    window.moveDisciple = function(dx, dy) {
        pPos.x += dx*20; pPos.y += dy*20;
        if(pPos.x > 340 && pPos.y > 260) alert("Je hebt Jezus gevonden!");
    };

    window.resetAllData = function() { if(confirm("Resetten?")) location.reload(); };

    // Live Namen Feed
    db.ref('spelers').on('value', s => {
        const list = document.getElementById('liveNames');
        if(s.exists()) {
            list.innerHTML = "<b>Nu online:</b><br>";
            Object.values(s.val()).forEach(v => list.innerHTML += v.naam + ", ");
        }
    });
</script>
</body>
</html>
