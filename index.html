<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schatgravers 2026 | Dirkjaap Master Control</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Black+Ops+One&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #1e3799; --accent: #eb4d4b; --bg: #0a3d62; --gold: #f1c40f; --neon: #00d2ff; }
        body { font-family: 'Fredoka', sans-serif; background: var(--bg); color: white; margin: 0; padding: 10px; overflow-x: hidden; }
        
        /* ADMIN PANEL - BOVENAAN VOOR REGIE */
        #admin-panel { display: none; background: #000; padding: 15px; border: 3px solid var(--gold); border-radius: 15px; margin-bottom: 20px; position: sticky; top: 0; z-index: 1000; box-shadow: 0 0 20px var(--gold); }
        .admin-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; }
        .btn-nav { background: #333; color: white; padding: 10px 2px; border-radius: 5px; border: 1px solid #555; cursor: pointer; font-size: 0.7rem; font-weight: bold; }
        .btn-nav.active-nav { background: var(--gold); color: black; border-color: white; transform: scale(1.05); }

        /* SCHERMEN */
        .screen { display: none; width: 100%; max-width: 500px; margin: 0 auto; text-align: center; }
        .screen.active { display: block; animation: slideIn 0.4s ease-out; }
        @keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .card { background: white; color: #333; padding: 20px; border-radius: 20px; margin: 15px 0; box-shadow: 0 10px 25px rgba(0,0,0,0.5); }
        
        /* WOORDZOEKER */
        #ws-grid { display: grid; grid-template-columns: repeat(10, 1fr); gap: 4px; background: #111; padding: 10px; border-radius: 15px; border: 2px solid var(--neon); }
        .ws-letter { background: white; aspect-ratio: 1; display: flex; align-items: center; justify-content: center; font-weight: 900; cursor: pointer; font-size: 1.2rem; border-radius: 4px; color: var(--primary); transition: 0.2s; user-select: none; }
        .ws-letter.selected { background: var(--accent); color: white; border-radius: 50%; }

        /* MAZE */
        #maze-container { position: relative; width: 300px; height: 300px; background: #000; border: 4px solid var(--neon); margin: 0 auto; border-radius: 10px; }
        #player { position: absolute; width: 30px; height: 30px; background: var(--gold); border-radius: 50%; z-index: 10; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        #guard { position: absolute; width: 40px; height: 40px; background: red; border-radius: 50%; z-index: 5; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .wall { position: absolute; background: #444; }

        /* UI ELEMENTS */
        .btn { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 12px; font-weight: bold; width: 100%; cursor: pointer; font-size: 1.1rem; }
        input { width: 100%; padding: 15px; border-radius: 12px; border: 2px solid #ddd; font-family: 'Fredoka'; font-size: 1rem; margin-bottom: 10px; }
        .player-tag { background: var(--neon); color: black; padding: 6px 12px; border-radius: 15px; margin: 3px; font-size: 0.8rem; font-weight: bold; display: inline-block; }
    </style>
</head>
<body>

    <div id="admin-panel">
        <div style="text-align:center; color:var(--gold); font-size:0.7rem; margin-bottom:5px;">REGIE PANEEL</div>
        <div class="admin-grid">
            <button class="btn-nav" id="nav1" onclick="syncStep(1)">LOBBY</button>
            <button class="btn-nav" id="nav2" onclick="syncStep(2)">KAART</button>
            <button class="btn-nav" id="nav3" onclick="syncStep(3)">STORY</button>
            <button class="btn-nav" id="nav4" onclick="syncStep(4)">FEED</button>
            <button class="btn-nav" id="nav5" onclick="syncStep(5)">PUZZEL</button>
            <button class="btn-nav" id="nav6" onclick="syncStep(6)">MATCH</button>
            <button class="btn-nav" id="nav7" onclick="syncStep(7)">MAZE</button>
            <button class="btn-nav" style="background:red" onclick="resetGame()">RESET</button>
        </div>
        <button class="btn-nav" style="width:100%; margin-top:8px; background:var(--gold); color:black" onclick="draaiWiel()">VOLGENDE STELLING</button>
    </div>

    <div id="screen-1" class="screen active">
        <h1 style="font-family:'Black Ops One'; font-size:3.5rem; color:var(--gold);">SQUAD</h1>
        <div class="card">
            <input type="text" id="name-in" placeholder="HOE HEET JE?">
            <button onclick="joinGame()" class="btn">START DE MISSIE</button>
        </div>
        <div id="names-list"></div>
    </div>

    <div id="screen-2" class="screen">
        <h2 style="color:var(--gold)">DE OLIJFBERG</h2>
        <div class="card" style="padding:0; height:400px; border:4px solid #fff">
            <iframe width="100%" height="100%" frameborder="0" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3392.2476579841!2d35.2422033!3d31.7774411!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x150329ea1004944d%3A0x6739985220c3882a!2sMount%20of%20Olives!5e0!3m2!1snl!2snl!4v1700000000000"></iframe>
        </div>
    </div>

    <div id="screen-3" class="screen">
        <div class="card" style="height:450px; overflow-y:scroll; text-align:left">
            <img src="schatgravers15maart.jpg" style="width:100%; border-radius:15px; margin-bottom:10px;">
            <h3>De Nacht in Gethsemane</h3>
            <p>Jezus zoekt de Olijfberg op. Hij is doodsbang. "Vader, laat deze beker aan Mij voorbijgaan," bidt Hij. Terwijl de leerlingen sliepen, kwam Judas... met een kus verraadde hij Jezus.</p>
        </div>
    </div>

    <div id="screen-4" class="screen">
        <div id="active-stelling" class="card" style="font-weight:bold; font-size:1.3rem; border:4px solid var(--neon);">Wachten op Dirkjaap...</div>
        <div class="card">
            <input type="text" id="opinion-in" placeholder="Wat vind jij?">
            <button onclick="stuurMening()" class="btn">VERSTUUR</button>
        </div>
        <div id="live-opinions"></div>
    </div>

    <div id="screen-5" class="screen">
        <h2 style="color:var(--gold)">ZOEK DE WOORDEN</h2>
        <div id="ws-grid"></div>
        <div id="ws-words" style="margin:10px 0; font-size:0.75rem; color:var(--neon); font-weight:bold"></div>
        <div class="card">
            <input type="text" id="secret-in" placeholder="DE GEHEIME OPLOSSING...">
            <button onclick="stuurGeheim()" class="btn">CHECK</button>
        </div>
    </div>

    <div id="screen-6" class="screen">
        <h2 style="color:var(--gold)">WIE ZEI WAT?</h2>
        <div id="draggables" style="margin-bottom:20px; display:flex; justify-content:center; gap:10px;">
            <div class="player-tag" draggable="true" id="d-jezus" style="padding:15px; font-size:1.1rem; cursor:grab">JEZUS</div>
            <div class="player-tag" draggable="true" id="d-petrus" style="padding:15px; font-size:1.1rem; cursor:grab">PETRUS</div>
        </div>
        <div class="card">
            <div class="drop-zone" data-target="d-jezus">"Vader, vergeef het hun..."</div>
            <div class="drop-zone" data-target="d-petrus">"Ik ken die man niet!"</div>
        </div>
    </div>

    <div id="screen-7" class="screen">
        <h2 style="color:var(--gold)">ONTWIJK JUDAS</h2>
        <div id="maze-container">
            <div class="wall" style="top:80px; left:0; width:220px; height:12px;"></div>
            <div class="wall" style="top:180px; left:80px; width:220px; height:12px;"></div>
            <div id="guard">üëπ</div>
            <div id="player" style="top:15px; left:15px;">üôè</div>
        </div>
        <div style="display:grid; grid-template-columns:repeat(3,1fr); width:150px; margin:20px auto; gap:10px;">
            <button class="btn" style="grid-column:2" onclick="moveMaze(0,-30)">‚Üë</button>
            <button class="btn" onclick="moveMaze(-30,0)">‚Üê</button>
            <button class="btn" onclick="moveMaze(0,30)">‚Üì</button>
            <button class="btn" onclick="moveMaze(30,0)">‚Üí</button>
        </div>
    </div>

    <script>
        // CONFIG
        const firebaseConfig = { apiKey: "AIzaSyBC3Dzm8PNPXw12VJNimvly5u2I93QeW54", databaseURL: "https://schatgravers15maart2026-default-rtdb.europe-west1.firebasedatabase.app", projectId: "schatgravers15maart2026" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let myName = "", isAdmin = false, pX=15, pY=15, guardInterval;

        // --- DE NAVIGATIE SYNC ---
        db.ref('currentStep').on('value', snap => {
            const step = snap.val() || 1;
            // Verberg alle schermen
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            // Toon het huidige scherm
            document.getElementById('screen-' + step).classList.add('active');
            
            // Update admin knoppen (welke is nu actief?)
            document.querySelectorAll('.btn-nav').forEach(b => b.classList.remove('active-nav'));
            if(isAdmin && document.getElementById('nav'+step)) document.getElementById('nav'+step).classList.add('active-nav');

            // Start specifieke functies per scherm
            if(step === 5) initWS();
            if(step === 7) initGuard(); else clearInterval(guardInterval);
        });

        // Admin functie om de stap te wijzigen
        function syncStep(n) { if(isAdmin) db.ref('currentStep').set(n); }

        function joinGame() {
            const n = document.getElementById('name-in').value.trim();
            if(n) {
                myName = n;
                db.ref('players').push(n);
                if(n.toLowerCase() === 'dirkjaap') {
                    isAdmin = true;
                    document.getElementById('admin-panel').style.display = 'block';
                }
            }
        }

        // --- DE REST VAN DE LOGICA ---
        db.ref('players').on('value', snap => {
            const l = document.getElementById('names-list'); l.innerHTML = "";
            if(snap.exists()) Object.values(snap.val()).forEach(n => l.innerHTML += `<span class="player-tag">${n}</span>`);
        });

        function initWS() {
            const g = document.getElementById('ws-grid'), w = document.getElementById('ws-words');
            const words = ["GETHSEMANE", "JUDAS", "VERZOENING", "GENADE", "OLIJFBERG", "ZWAARD", "ENGEL", "SLAAP", "KUS"];
            let grid = Array(100).fill('');
            const place = (word, start, step) => { for(let i=0; i<word.length; i++) grid[start + (i*step)] = word[i]; };
            place("GETHSEMANE", 0, 1); place("VERZOENING", 10, 1); place("JUDAS", 40, 1); place("GENADE", 50, 1); 
            place("OLIJFBERG", 60, 1); place("ZWAARD", 70, 1); place("ENGEL", 80, 1); place("SLAAP", 90, 1); place("KUS", 96, 1);

            const oplossing = "GODGEEFTKRACHT".split('');
            let opIdx = 0;
            for(let i=0; i<100; i++) {
                if(grid[i] === '' && opIdx < oplossing.length) { grid[i] = oplossing[opIdx]; opIdx++; }
                else if(grid[i] === '') { grid[i] = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*26)]; }
            }
            g.innerHTML = ""; w.innerHTML = words.join(" ‚Ä¢ ");
            grid.forEach(l => {
                const d = document.createElement('div'); d.className='ws-letter'; d.innerText=l;
                d.onclick = function() { this.classList.toggle('selected'); };
                g.appendChild(d);
            });
        }

        function stuurMening() {
            const t = document.getElementById('opinion-in').value;
            if(t) { db.ref('opinions').push({n: myName, t: t}); document.getElementById('opinion-in').value = ""; }
        }
        db.ref('opinions').limitToLast(4).on('value', snap => {
            const l = document.getElementById('live-opinions'); l.innerHTML = "";
            snap.forEach(c => l.innerHTML = `<div class="card" style="padding:10px; margin:5px; font-size:0.8rem"><b>${c.val().n}:</b> ${c.val().t}</div>` + l.innerHTML);
        });

        function moveMaze(dx,dy) {
            pX+=dx; pY+=dy; if(pX<0)pX=0; if(pX>265)pX=265; if(pY<0)pY=0; if(pY>265)pY=265;
            document.getElementById('player').style.left=pX+'px'; document.getElementById('player').style.top=pY+'px';
            if(pX > 240 && pY > 240) alert("GEWONNEN!");
        }

        function draaiWiel() {
            const s = ["Zou jij je zwaard trekken?", "Is Judas echt slecht?", "Wat doe jij als je bang bent?"];
            db.ref('activeStelling').set(s[Math.floor(Math.random()*s.length)]);
        }
        db.ref('activeStelling').on('value', snap => { document.getElementById('active-stelling').innerText = snap.val() || "Wachten..."; });

        function resetGame() { if(confirm("ALLES RESETTEN?")) db.ref('/').set({currentStep:1}); }

        // Drag/Drop
        document.addEventListener('dragstart', e => { if(e.target.classList.contains('player-tag')) e.dataTransfer.setData('text', e.target.id); });
        document.addEventListener('dragover', e => e.preventDefault());
        document.addEventListener('drop', e => {
            const zone = e.target.closest('.drop-zone');
            if(zone && zone.dataset.target === e.dataTransfer.getData('text')) {
                zone.style.background = "#d4edda"; zone.appendChild(document.getElementById(e.dataTransfer.getData('text')));
            }
        });
    </script>
</body>
</html>
