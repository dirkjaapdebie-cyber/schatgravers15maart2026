<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schatgravers Live - Het Grote Avontuur</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4834d4; --accent: #eb4d4b; --success: #6ab04c;
            --white: rgba(255, 255, 255, 0.95); --gold: #f9ca24;
            --sky: #686de0;
        }

        body, html { margin: 0; padding: 0; height: 100vh; font-family: 'Fredoka', sans-serif; overflow: hidden; background: #130f40; color: #2d3436; }
        
        /* Bewegende achtergrond */
        .bg-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('schatgravers15maart.jpg'); background-size: cover; background-position: center;
            filter: blur(8px) brightness(0.4); z-index: -2; transition: 1s;
        }

        /* Dynamische Reis-Tracker */
        .travel-bar {
            position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
            width: 80%; height: 60px; background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px); border-radius: 30px; display: flex; 
            align-items: center; justify-content: space-between; padding: 0 30px; z-index: 100;
            border: 2px solid rgba(255,255,255,0.2);
        }
        .travel-dot { width: 40px; height: 40px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; transition: 0.5s; opacity: 0.4; }
        .travel-dot.active { opacity: 1; transform: scale(1.3); box-shadow: 0 0 20px var(--gold); background: var(--gold); }

        /* Kaartjes Styling */
        .card { 
            background: var(--white); border-radius: 40px; 
            box-shadow: 0 20px 40px rgba(0,0,0,0.4); animation: slideIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border-bottom: 8px solid rgba(0,0,0,0.1);
        }

        /* FASE 1: SPEELS AANMELDEN */
        #phase-1 { display: none; height: 100vh; flex-direction: column; align-items: center; justify-content: center; }
        .welcome-box { padding: 40px; text-align: center; max-width: 500px; }

        /* FASE 2: STORY-SCROLL */
        #phase-2 { display: none; height: 100vh; padding: 100px 40px 40px; box-sizing: border-box; }
        .story-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; height: 100%; width: 100%; }
        .story-text-area { padding: 30px; overflow-y: auto; font-size: 1.2rem; line-height: 1.5; }
        .map-visual { border-radius: 30px; background: url('https://images.unsplash.com/photo-1549102011-8276f70f6128?q=80&w=1000&auto=format&fit=crop') center; background-size: cover; position: relative; }
        .ede-marker { position: absolute; top: 20px; left: 20px; background: var(--accent); color: white; padding: 10px 20px; border-radius: 20px; font-weight: bold; transform: rotate(-5deg); }

        /* FASE 3: DOBBELSTEEN */
        #phase-3 { display: none; padding: 100px 20px 20px; height: 100vh; box-sizing: border-box; }
        .dice-container { display: flex; gap: 20px; height: 100%; }

        /* Admin knoppen kleiner en subtieler */
        .admin-nav { position: fixed; bottom: 10px; right: 10px; opacity: 0.3; transition: 0.3s; z-index: 1000; }
        .admin-nav:hover { opacity: 1; }

        @keyframes slideIn { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .bubble { background: white; padding: 15px 20px; border-radius: 25px 25px 25px 5px; margin: 10px; box-shadow: 0 10px 15px rgba(0,0,0,0.1); font-weight: 600; transition: 0.3s; }
    </style>
</head>
<body>

<div class="bg-overlay" id="bg"></div>

<div class="travel-bar">
    <div class="travel-dot" id="dot-p1">üè†</div>
    <div style="flex:1; border-top: 3px dashed rgba(255,255,255,0.3); margin: 0 15px;"></div>
    <div class="travel-dot" id="dot-p2">‚úàÔ∏è</div>
    <div style="flex:1; border-top: 3px dashed rgba(255,255,255,0.3); margin: 0 15px;"></div>
    <div class="travel-dot" id="dot-p3">üå≥</div>
</div>

<div id="phase-1">
    <div class="card welcome-box">
        <h1 style="color:var(--primary); margin-top:0;">Reis je mee? üéí</h1>
        <p>We verzamelen bij de <strong>Proosdijkerk</strong>. Laat weten dat je er bent!</p>
        <input type="text" id="name-in" placeholder="Je voornaam..." style="width:80%; padding:15px; border-radius:20px; border:2px solid #ddd; margin-bottom:15px; font-size:1.1rem; font-family:'Fredoka';">
        <button onclick="sendName()" style="width:80%; padding:15px; background:var(--success); color:white; border:none; border-radius:20px; font-weight:bold; cursor:pointer; font-size:1.1rem;">IK DOE MEE! ‚ú®</button>
        <div id="names-list" style="margin-top:20px; display:flex; gap:8px; flex-wrap:wrap; justify-content:center;"></div>
    </div>
</div>

<div id="phase-2">
    <div class="story-grid">
        <div class="card story-text-area">
            <h2 style="color:var(--accent); margin-top:0;">De Grote Reis üó∫Ô∏è</h2>
            <p>Stel je voor: we rijden de parkeerplaats bij de <strong>Proosdijkerk</strong> af. De rotonde over, en dan... nog 4.400 kilometer gaan!</p>
            <p style="background: #fff9e6; padding: 15px; border-radius: 15px; font-size: 1rem;">
                Dat is alsof je <strong>11.000 keer</strong> rond het voetbalveld van Ede rent!
            </p>
            <p>Eindelijk komen we aan bij de Olijfberg. Het is nacht. De wind waait zachtjes door de oude bomen. Jezus is hier, en Hij heeft onze hulp (en gebeden) nodig.</p>
            <a href="https://earth.google.com/web/search/Mount+of+Olives,+Jerusalem" target="_blank" style="text-decoration:none; display:block; text-align:center; background:var(--primary); color:white; padding:15px; border-radius:20px; font-weight:bold;">BEKIJK DE BERG IN 3D üåç</a>
        </div>
        <div class="map-visual">
            <div class="ede-marker">START: EDE üìç</div>
        </div>
    </div>
</div>

<div id="phase-3">
    <div class="dice-container">
        <div class="card" style="width:350px; padding:30px; display:flex; flex-direction:column; align-items:center; justify-content:center;">
            <div class="scene"><div class="cube" id="cube" style="width:100px; height:100px; position:relative; transform-style:preserve-3d; transition:1.2s;">
                <div class="cube__face cube__face--1" style="position:absolute; width:100px; height:100px; background:white; border:4px solid var(--primary); line-height:100px; font-size:40px; text-align:center; transform:rotateY(0deg) translateZ(50px);">1</div>
                <div class="cube__face cube__face--2" style="position:absolute; width:100px; height:100px; background:white; border:4px solid var(--primary); line-height:100px; font-size:40px; text-align:center; transform:rotateY(180deg) translateZ(50px);">2</div>
                <div class="cube__face cube__face--3" style="position:absolute; width:100px; height:100px; background:white; border:4px solid var(--primary); line-height:100px; font-size:40px; text-align:center; transform:rotateY(-90deg) translateZ(50px);">3</div>
                <div class="cube__face cube__face--4" style="position:absolute; width:100px; height:100px; background:white; border:4px solid var(--primary); line-height:100px; font-size:40px; text-align:center; transform:rotateY(90deg) translateZ(50px);">4</div>
                <div class="cube__face cube__face--5" style="position:absolute; width:100px; height:100px; background:white; border:4px solid var(--primary); line-height:100px; font-size:40px; text-align:center; transform:rotateX(-90deg) translateZ(50px);">5</div>
                <div class="cube__face cube__face--6" style="position:absolute; width:100px; height:100px; background:white; border:4px solid var(--primary); line-height:100px; font-size:40px; text-align:center; transform:rotateX(90deg) translateZ(50px);">6</div>
            </div></div>
            <button onclick="triggerRoll()" style="width:100%; padding:15px; background:var(--primary); color:white; border:none; border-radius:20px; font-weight:bold; cursor:pointer; margin:20px 0;">GOOI DE DOBBELSTEEN üé≤</button>
            <div id="active-stmt" style="text-align:center; font-weight:bold; color:var(--primary); font-size:1.1rem; min-height:80px;">Druk op de knop!</div>
            <input type="text" id="thought-in" placeholder="Jouw gedachte..." style="width:100%; padding:12px; border-radius:15px; border:1px solid #ddd; margin-bottom:10px;">
            <button onclick="sendThought()" style="width:100%; padding:12px; background:var(--success); color:white; border:none; border-radius:15px; font-weight:bold;">DEEL ‚ú®</button>
        </div>
        <div id="live-thoughts" style="flex:1; overflow-y:auto; display:flex; flex-wrap:wrap; align-content:start;"></div>
    </div>
</div>

<div class="admin-nav">
    <button onclick="updatePhase('p1')">1</button>
    <button onclick="updatePhase('p2')">2</button>
    <button onclick="updatePhase('p3')">3</button>
    <button onclick="hardReset()" style="background:red; color:white;">X</button>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, onValue, push, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBC3Dzm8PNPXw12VJNimvly5u2I93QeW54",
        authDomain: "schatgravers15maart2026.firebaseapp.com",
        projectId: "schatgravers15maart2026",
        databaseURL: "https://schatgravers15maart2026-default-rtdb.europe-west1.firebasedatabase.app",
        storageBucket: "schatgravers15maart2026.firebasestorage.app",
        messagingSenderId: "30561512857",
        appId: "1:30561512857:web:fcb7868b87d292d1c97708"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const stellingen = [
        "ANGST: Wanneer ben jij bang, net als Jezus op de berg?",
        "KEUZES: Vind je het lastig om het goede te doen als anderen niet kijken?",
        "ENGELEN: Wie was er voor jou een 'engel' toen je hulp nodig had?",
        "BIDDEN: Hoe praat jij met God?",
        "ALLEEN: Voel je je wel eens alleen, zoals Jezus door zijn vrienden?",
        "HERSTEL: Hoe maak jij iets wat kapot is weer goed?"
    ];

    window.updatePhase = (p) => set(ref(db, 'currentPhase'), p);
    window.sendName = () => { const v = document.getElementById('name-in').value; if(v) push(ref(db, 'names'), v); document.getElementById('name-in').value=''; };
    window.triggerRoll = () => set(ref(db, 'gameState'), {r: Math.floor(Math.random()*6)+1, t: Date.now()});
    window.sendThought = () => { const v = document.getElementById('thought-in').value; if(v) push(ref(db, 'live'), v); document.getElementById('thought-in').value=''; };
    window.hardReset = () => { if(confirm("Reset?")) remove(ref(db, '/')); };

    onValue(ref(db, 'currentPhase'), s => {
        const p = s.val() || 'p1';
        document.getElementById('phase-1').style.display = (p === 'p1') ? 'flex' : 'none';
        document.getElementById('phase-2').style.display = (p === 'p2') ? 'flex' : 'none';
        document.getElementById('phase-3').style.display = (p === 'p3') ? 'flex' : 'none';
        
        document.querySelectorAll('.travel-dot').forEach(d => d.classList.remove('active'));
        document.getElementById('dot-' + p).classList.add('active');
        document.getElementById('bg').style.filter = (p === 'p3') ? 'blur(10px) brightness(0.2)' : 'blur(8px) brightness(0.4)';
    });

    onValue(ref(db, 'names'), s => {
        const list = document.getElementById('names-list'); list.innerHTML = "";
        const data = s.val(); if(data) Object.values(data).forEach(n => {
            list.innerHTML += `<span style="background:var(--sky); color:white; padding:5px 12px; border-radius:15px; font-size:0.9rem;">${n}</span>`;
        });
    });

    onValue(ref(db, 'gameState'), s => {
        const d = s.val(); if(d) {
            const rotations = {1:'rotateY(0deg)', 2:'rotateY(180deg)', 3:'rotateY(-90deg)', 4:'rotateY(90deg)', 5:'rotateX(-90deg)', 6:'rotateX(90deg)'};
            document.getElementById('cube').style.transform = rotations[d.r];
            document.getElementById('active-stmt').innerText = stellingen[d.r-1];
        }
    });

    onValue(ref(db, 'live'), s => {
        const grid = document.getElementById('live-thoughts'); grid.innerHTML = "";
        const data = s.val(); if(data) Object.values(data).reverse().forEach(t => {
            grid.innerHTML += `<div class="bubble">${t}</div>`;
        });
    });
</script>
</body>
</html>
