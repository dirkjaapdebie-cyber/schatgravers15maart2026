<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Schatgravers - Olijfberg Experience</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: manipulation; }
        body { font-family: 'Fredoka', sans-serif; background: #0a3d62; min-height: 100vh; display: flex; justify-content: center; padding: 10px; }
        #app { width: 100%; max-width: 450px; position: relative; }
        .screen { display: none; background: white; border-radius: 30px; padding: 20px; min-height: 85vh; box-shadow: 0 20px 40px rgba(0,0,0,0.4); flex-direction: column; }
        .screen.active { display: flex; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        #nav-bar { background: #1e3799; color: white; padding: 12px; border-radius: 50px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 5px 15px rgba(0,0,0,0.3); gap: 10px; }
        .nav-btn { background: #f6b93b; border: none; padding: 10px 20px; border-radius: 30px; font-weight: bold; cursor: pointer; color: #1e3799; font-size: 1rem; }
        #reset-btn { background: #e55039; color: white; }
        #screen-title { font-weight: 600; font-size: 1.2rem; }

        h2 { color: #1e3799; margin-bottom: 15px; text-align: center; }
        input, textarea { width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #ddd; border-radius: 15px; font-family: 'Fredoka', sans-serif; font-size: 16px; }
        .btn { background: #1e3799; color: white; border: none; padding: 15px; border-radius: 50px; font-weight: bold; width: 100%; cursor: pointer; font-size: 1.1rem; margin: 10px 0; }

        /* Scherm 1 */
        .live-feed { background: #f1f2f6; padding: 15px; border-radius: 20px; margin-top: 20px; max-height: 250px; overflow-y: auto; }
        .name-tag { background: white; padding: 12px; margin: 5px 0; border-radius: 10px; border-left: 5px solid #20bf6b; }

        /* Scherm 3 */
        .story-box { background: #fdf6e3; padding: 25px; border-radius: 20px; border-left: 8px solid #f6b93b; max-height: 500px; overflow-y: auto; }
        .story-text { line-height: 1.8; font-size: 1.1rem; }

        /* Scherm 4 - Rad */
        .wheel-wrapper { position: relative; width: 280px; height: 280px; margin: 10px auto; }
        #wheel { width: 100%; height: 100%; border-radius: 50%; border: 5px solid #333; transition: transform 3s cubic-bezier(0.25, 0.1, 0.15, 1); background: conic-gradient(#f6b93b 0 60deg, #1e3799 60deg 120deg, #20bf6b 120deg 180deg, #e55039 180deg 240deg, #fa983a 240deg 300deg, #b71540 300deg 360deg); }
        #pointer { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); font-size: 40px; z-index: 10; }
        .stelling-card { background: #f8f9fa; padding: 15px; border-radius: 15px; margin: 15px 0; border: 2px solid #1e3799; display: none; }
        .stelling-card.active { display: block; }
        .answers-feed { background: #f1f2f6; padding: 10px; border-radius: 10px; margin-top: 10px; max-height: 150px; overflow-y: auto; }

        /* Scherm 5 - Drag & Drop */
        .drag-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 15px 0; }
        .figuur-col, .gebed-col { background: #f1f2f6; padding: 15px; border-radius: 15px; max-height: 450px; overflow-y: auto; }
        .figuur-card { background: white; padding: 12px; margin: 8px 0; border-radius: 12px; border: 2px solid #1e3799; cursor: grab; text-align: center; font-weight: bold; }
        .gebed-card { background: #e3f2fd; padding: 12px; margin: 8px 0; border-radius: 12px; border: 2px dashed #1e3799; min-height: 70px; font-size: 0.85rem; }
        .gebed-card.matched { background: #c8e6c9; border: 2px solid #20bf6b; }

        /* Scherm 6 */
        .word-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 20px 0; }
        .letter-tile { background: #1e3799; color: white; font-size: 1.5rem; font-weight: bold; padding: 15px; border-radius: 15px; text-align: center; cursor: pointer; }
        .letter-tile.selected { background: #f6b93b; color: #1e3799; }

        /* Scherm 7 */
        #mazeCanvas { width: 100%; height: 300px; background: #2d5a27; border-radius: 20px; border: 4px solid #8B4513; }
    </style>
</head>
<body>

<div id="app">
    <div id="nav-bar">
        <span id="screen-title">Inloggen</span>
        <div class="nav-buttons">
            <button class="nav-btn" id="reset-btn" onclick="resetAllData()">üîÑ Reset</button>
            <button class="nav-btn" onclick="nextScreen()">Volgende ‚ûî</button>
        </div>
    </div>

    <div id="screen1" class="screen active">
        <h2>üëã Welkom Schatgraver!</h2>
        <input type="text" id="playerName" placeholder="Jouw naam...">
        <button class="btn" onclick="login()">Start het avontuur</button>
        <div class="live-feed">
            <h4>üì± Live deelnemers:</h4>
            <div id="liveNames"></div>
        </div>
    </div>

    <div id="screen2" class="screen">
        <h2>üèîÔ∏è De Olijfberg</h2>
        <div style="height: 350px; border-radius: 20px; overflow: hidden; border: 3px solid #ddd;">
            <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3392.564547905878!2d35.24222221523456!3d31.778055581285215!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x150329eb965a396b%3A0x6a0531b7474a006e!2sMount%20of%20Olives!5e0!3m2!1sen!2snl!4v1647000000000" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
        </div>
        <p style="margin-top:15px;">Dit is de Olijfberg, waar Jezus vaak kwam om te bidden.</p>
    </div>

    <div id="screen3" class="screen">
        <h2>üìñ Het verhaal</h2>
        <div class="story-box">
            <div class="story-text">
                <h3>Jezus bidt op de Olijfberg</h3>
                <p>Jezus ging met zijn leerlingen naar de Olijfberg, zoals Hij gewend was. Toen ze daar aangekomen waren, zei Hij tegen hen: "Bid dat jullie niet in verzoeking komen."</p>
                <p>Hijzelf ging een eindje verder, zo ver als een steenworp, en knielde neer. Hij bad: "Vader, als U wilt, neem dan deze beker van Mij weg. Maar laat niet Mijn wil gebeuren, maar de Uwe."</p>
                <p>Toen verscheen er een engel uit de hemel om Hem kracht te geven. In doodsangst bad Hij vuriger. Zijn zweet viel als druppels bloed op de grond.</p>
                <p>Na dit gebed stond Hij op en ging terug naar Zijn leerlingen. Hij vond hen slapend, want ze waren uitgeput van verdriet. Hij zei: "Waarom slapen jullie? Sta op en bid dat jullie niet in verzoeking komen."</p>
                <h3>Judas verraadt Jezus</h3>
                <p>Terwijl Hij nog sprak, kwam er een menigte. Judas, √©√©n van de twaalf, liep voorop. Hij naderde Jezus om Hem kussen. Maar Jezus zei: "Judas, verraad je de Mensenzoon met een kus?"</p>
                <p>Toen de leerlingen zagen wat er ging gebeuren, vroegen ze: "Heer, zullen we met het zwaard terugslaan?" En √©√©n van hen sloeg de dienaar van de hogepriester en hakte zijn rechteroor af.</p>
                <p>Jezus zei: "Houd op! Genoeg!" En Hij raakte het oor aan en genas de man. Tegen de hogepriesters, tempelhoofden en oudsten die gekomen waren, zei Jezus: "Met zwaarden en knuppels bent u gekomen alsof Ik een misdadiger ben. Elke dag was Ik bij u in de tempel, maar u deed Mij niets. Maar dit is uw uur, de tijd dat de duisternis regeert."</p>
                <p style="font-style: italic; margin-top: 20px;">‚Äî Lucas 22:39-53</p>
            </div>
        </div>
    </div>

    <div id="screen4" class="screen">
        <h2>üé° Rad van Fortuin</h2>
        <div class="wheel-wrapper">
            <div id="wheel"></div>
            <div id="pointer">‚ñº</div>
        </div>
        <button class="btn" style="background:#f6b93b; color:#1e3799;" onclick="spinWheel()">üé≤ Draaien!</button>
        <div id="currentStelling"></div>
        <div id="stellingenContainer"></div>
    </div>

    <div id="screen5" class="screen">
        <h2>üôè Gebeden Match</h2>
        <div class="drag-container" id="dragDropArea"></div>
        <button class="btn" style="background:#20bf6b;" onclick="checkAllMatches()">‚úÖ Controleer</button>
        <div id="dragResult" style="text-align:center; font-weight:bold;"></div>
    </div>

    <div id="screen6" class="screen">
        <h2>üî§ Zoek de woorden</h2>
        <div class="target-word" id="targetDisplay" style="text-align:center; font-size:1.5rem; font-weight:bold; color:#1e3799; margin:10px;"></div>
        <div class="word-grid" id="letterGrid"></div>
        <button class="btn" onclick="checkWord()">‚úÖ Controleer</button>
        <div id="wordResult" style="text-align:center;"></div>
    </div>

    <div id="screen7" class="screen">
        <h2>üèÉ Doolhof</h2>
        <canvas id="mazeCanvas"></canvas>
        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 180px; margin: 20px auto;">
            <div></div><button class="btn" style="margin:0" onclick="moveDisciple(0,-10)">‚Üë</button><div></div>
            <button class="btn" style="margin:0" onclick="moveDisciple(-10,0)">‚Üê</button><button class="btn" style="margin:0" onclick="moveDisciple(0,10)">‚Üì</button><button class="btn" style="margin:0" onclick="moveDisciple(10,0)">‚Üí</button>
        </div>
        <button class="btn" style="background:#20bf6b;" onclick="finishMaze()">üèÅ Omhels Jezus</button>
    </div>
</div>

<script>
    // Firebase Config
    const firebaseConfig = {
        apiKey: "AIzaSyBC3Dzm8PNPXw12VJNimvly5u2I93QeW54",
        authDomain: "schatgravers15maart2026.firebaseapp.com",
        databaseURL: "https://schatgravers15maart2026-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "schatgravers15maart2026",
        appId: "1:30561512857:web:fcb7868b87d292d1c97708"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let currentScreen = 1;
    let currentUser = '';
    let selectedLetters = [];
    let dragMatches = {};

    const stellingen = [
        "Ik ben nooit bang.",
        "Als ik iets heel spannend vind, hoop ik dat het niet doorgaat.",
        "Als ik zie dat iemand het moeilijk heeft, probeer ik te helpen.",
        "Als ik bang ben, ga ik bidden.",
        "Ik heb weleens kracht van God gevoeld.",
        "Ik wil meer weten over wat God wil."
    ];

    const gebedenMatch = [
        { figuur: "Abraham", gebed: "Ik bid dat er geen onschuldige mensen in de stad Sodom gedood zullen worden." },
        { figuur: "Agur", gebed: "Ik bid om altijd eerlijk te zijn en om precies te krijgen wat ik nodig heb." },
        { figuur: "David", gebed: "Ik bid om vergeving omdat ik iemand vermoord heb." },
        { figuur: "Elia", gebed: "Ik bid dat God mij antwoord geeft." },
        { figuur: "Gideon", gebed: "Ik vraag God om een teken." },
        { figuur: "Hanna", gebed: "Ik bid om een zoon." },
        { figuur: "Jesaja", gebed: "Ik bid dat God vanuit de hemel naar ons kijkt." },
        { figuur: "Jezus", gebed: "Ik bid voor alle mensen die in mij zullen geloven." },
        { figuur: "Job", gebed: "Ik bid dat God aan mij denkt." },
        { figuur: "Mozes", gebed: "Ik probeer God op andere gedachten te brengen." },
        { figuur: "Nehemia", gebed: "Ik doe in stilte een schietgebedje." },
        { figuur: "Paulus", gebed: "Ik vraag aan anderen om voor mij te bidden." },
        { figuur: "Salomo", gebed: "Ik bid om het verschil tussen goed en kwaad te zien." }
    ];

    const words = ['GETSEMANE', 'OLIJFBERG', 'JEZUS', 'NARCISSEN', 'OPBLOEIEN'];
    let currentWord = '';

    // NAVIGATIE
    window.nextScreen = function() {
        document.getElementById(`screen${currentScreen}`).classList.remove('active');
        currentScreen = currentScreen < 7 ? currentScreen + 1 : 1;
        document.getElementById(`screen${currentScreen}`).classList.add('active');
        const titles = ['', 'Inloggen', 'Olijfberg', 'Verhaal', 'Rad', 'Gebeden', 'Woordveld', 'Doolhof'];
        document.getElementById('screen-title').innerText = titles[currentScreen];

        if(currentScreen === 4) initStellingen();
        if(currentScreen === 5) initDragDrop();
        if(currentScreen === 6) initWordGame();
        if(currentScreen === 7) initMaze();
    };

    // SCHERM 1: LOGIN
    window.login = function() {
        const name = document.getElementById('playerName').value.trim();
        if(name) {
            currentUser = name;
            db.ref('spelers').push({ naam: name, tijd: Date.now() });
            nextScreen();
        } else { alert('Voer je naam in!'); }
    };

    db.ref('spelers').on('value', (snapshot) => {
        const list = document.getElementById('liveNames');
        if(list && snapshot.exists()) {
            list.innerHTML = '';
            Object.values(snapshot.val()).reverse().forEach(speler => {
                list.innerHTML += `<div class="name-tag">üëã <b>${speler.naam}</b> doet mee!</div>`;
            });
        }
    });

    // SCHERM 4: RAD
    window.initStellingen = function() {
        const container = document.getElementById('stellingenContainer');
        container.innerHTML = stellingen.map((s, i) => `
            <div id="stelling${i+1}" class="stelling-card">
                <strong>Stelling ${i+1}:</strong> ${s}
                <textarea id="antwoord${i+1}" placeholder="Jouw gedachten..."></textarea>
                <button class="btn" style="padding:10px" onclick="saveAnswer(${i+1})">üíæ Opslaan</button>
                <div class="answers-feed" id="feed${i+1}"></div>
            </div>
        `).join('');
        
        for(let i=1; i<=6; i++) {
            db.ref(`antwoorden/stelling${i}`).on('value', (snap) => {
                const feed = document.getElementById(`feed${i}`);
                if(feed && snap.exists()) {
                    feed.innerHTML = Object.values(snap.val()).reverse().map(a => `<div style="font-size:0.8rem"><b>${a.naam}:</b> ${a.antwoord}</div>`).join('');
                }
            });
        }
    };

    window.spinWheel = function() {
        const wheel = document.getElementById('wheel');
        const spin = Math.floor(Math.random() * 360) + 720;
        wheel.style.transform = `rotate(${spin}deg)`;
        setTimeout(() => {
            const segment = Math.floor((spin % 360) / 60) + 1;
            document.querySelectorAll('.stelling-card').forEach(el => el.classList.remove('active'));
            document.getElementById(`stelling${segment}`).classList.add('active');
        }, 3000);
    };

    window.saveAnswer = function(nr) {
        const antw = document.getElementById(`antwoord${nr}`).value;
        if(antw) db.ref(`antwoorden/stelling${nr}`).push({ naam: currentUser, antwoord: antw });
    };

    // SCHERM 5: DRAG DROP
    window.initDragDrop = function() {
        const area = document.getElementById('dragDropArea');
        area.innerHTML = '<div class="figuur-col" id="fCol"></div><div class="gebed-col" id="gCol"></div>';
        
        const figuren = [...new Set(gebedenMatch.map(g => g.figuur))];
        figuren.forEach(f => {
            const div = document.createElement('div');
            div.className = 'figuur-card'; div.draggable = true; div.innerText = f;
            div.ondragstart = (e) => e.dataTransfer.setData('text', f);
            document.getElementById('fCol').appendChild(div);
        });

        gebedenMatch.sort(() => Math.random() - 0.5).forEach((item, i) => {
            const div = document.createElement('div');
            div.className = 'gebed-card'; div.id = `g-${i}`;
            div.innerHTML = `<small>${item.gebed}</small>`;
            div.ondragover = (e) => e.preventDefault();
            div.ondrop = (e) => {
                const f = e.dataTransfer.getData('text');
                if(f === item.figuur) {
                    div.classList.add('matched'); div.innerHTML += `<br><b>‚úì ${f}</b>`;
                    dragMatches[i] = true;
                }
            };
            document.getElementById('gCol').appendChild(div);
        });
    };

    window.checkAllMatches = function() {
        const count = Object.keys(dragMatches).length;
        document.getElementById('dragResult').innerText = `Je hebt er ${count} van de ${gebedenMatch.length} goed!`;
    };

    // SCHERM 6: WOORDEN
    window.initWordGame = function() {
        currentWord = words[Math.floor(Math.random() * words.length)];
        document.getElementById('targetDisplay').innerText = '_ '.repeat(currentWord.length);
        const grid = document.getElementById('letterGrid');
        grid.innerHTML = '';
        let letters = currentWord.split('');
        while(letters.length < 16) letters.push(String.fromCharCode(65 + Math.floor(Math.random() * 26)));
        letters.sort(() => Math.random() - 0.5).forEach(l => {
            const div = document.createElement('div');
            div.className = 'letter-tile'; div.innerText = l;
            div.onclick = () => { div.classList.toggle('selected'); updateWordDisplay(); };
            grid.appendChild(div);
        });
    };

    function updateWordDisplay() {
        const sel = Array.from(document.querySelectorAll('.letter-tile.selected')).map(d => d.innerText).join('');
        document.getElementById('wordResult').innerText = "Geselecteerd: " + sel;
    }

    window.checkWord = function() {
        const sel = Array.from(document.querySelectorAll('.letter-tile.selected')).map(d => d.innerText).join('');
        if(sel === currentWord) alert("Goed gedaan!"); else alert("Nog niet de juiste combinatie...");
    };

    // SCHERM 7: DOOLHOF
    let pPos = {x: 20, y: 20};
    window.initMaze = function() {
        const canvas = document.getElementById('mazeCanvas');
        const ctx = canvas.getContext('2d');
        function draw() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            ctx.fillStyle = "blue"; ctx.fillRect(pPos.x, pPos.y, 15, 15);
            ctx.fillStyle = "yellow"; ctx.fillText("üôè JEZUS", 250, 130);
            requestAnimationFrame(draw);
        }
        draw();
    };

    window.moveDisciple = function(dx, dy) {
        pPos.x += dx; pPos.y += dy;
    };

    window.resetAllData = function() { if(confirm("Alles wissen?")) { db.ref().remove(); location.reload(); }};
</script>
</body>
</html>
