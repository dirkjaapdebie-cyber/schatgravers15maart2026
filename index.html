<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schatgravers 2026 | Mission Control</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Black+Ops+One&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #1e3799; --accent: #eb4d4b; --bg: #0a3d62; --gold: #f1c40f; --neon: #00d2ff; }
        body { font-family: 'Fredoka', sans-serif; background: var(--bg); color: white; margin: 0; padding: 10px; overflow-x: hidden; }
        
        /* ADMIN */
        #admin-panel { display: none; background: #000; padding: 15px; border: 3px solid var(--gold); border-radius: 15px; margin-bottom: 20px; position: sticky; top: 0; z-index: 1000; }
        .admin-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 5px; }
        .btn-nav { background: #333; color: white; padding: 8px 2px; border-radius: 5px; border: 1px solid #555; cursor: pointer; font-size: 0.6rem; font-weight: bold; text-transform: uppercase; }
        .btn-nav.active-nav { background: var(--gold); color: black; }

        /* SCHERMEN */
        .screen { display: none; width: 100%; max-width: 600px; margin: 0 auto; text-align: center; }
        .screen.active { display: block; }
        .card { background: white; color: #333; padding: 20px; border-radius: 20px; margin: 15px 0; box-shadow: 0 10px 25px rgba(0,0,0,0.5); }
        .scroll-area { height: 350px; overflow-y: auto; text-align: left; padding: 15px; border: 1px solid #eee; border-radius: 10px; white-space: pre-wrap; line-height: 1.6; }

        /* GEBEDEN DRAG DROP */
        .name-pool { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 15px; justify-content: center; }
        .drag-name { background: var(--neon); color: black; padding: 6px 10px; border-radius: 8px; cursor: grab; font-weight: bold; font-size: 0.75rem; }
        .prayer-row { display: flex; align-items: flex-start; gap: 8px; background: #f1f2f6; padding: 10px; margin-bottom: 5px; border-radius: 10px; font-size: 0.8rem; }
        .drop-zone { min-width: 80px; min-height: 30px; border: 2px dashed #ccc; border-radius: 5px; background: white; }

        /* MAZE EXTREME */
        #maze-container { position: relative; width: 300px; height: 300px; background: #111; border: 4px solid var(--neon); margin: 0 auto; overflow: hidden; }
        #player { position: absolute; width: 30px; height: 30px; z-index: 100; font-size: 24px; transition: 0.1s; }
        .soldier { position: absolute; width: 30px; height: 30px; z-index: 90; font-size: 24px; transition: 0.5s; }
        .wall { position: absolute; background: #444; }
        #maze-timer { font-family: 'Black Ops One'; font-size: 2rem; color: var(--accent); margin-bottom: 10px; }

        /* ALGEMEEN */
        .btn { background: var(--primary); color: white; border: none; padding: 15px; border-radius: 12px; font-weight: bold; width: 100%; cursor: pointer; }
        input { width: 100%; padding: 12px; border-radius: 10px; border: 2px solid #ddd; margin-bottom: 8px; box-sizing: border-box; }
    </style>
</head>
<body>

    <div id="admin-panel">
        <div class="admin-grid">
            <button class="btn-nav" id="nav1" onclick="setStep(1)">1. Lobby</button>
            <button class="btn-nav" id="nav2" onclick="setStep(2)">2. Kaart</button>
            <button class="btn-nav" id="nav3" onclick="setStep(3)">3. Story</button>
            <button class="btn-nav" id="nav4" onclick="setStep(4)">4. Gebeden</button>
            <button class="btn-nav" id="nav5" onclick="setStep(5)">5. Wheel</button>
            <button class="btn-nav" id="nav6" onclick="setStep(6)">6. Puzzel</button>
            <button class="btn-nav" id="nav7" onclick="setStep(7)">7. Maze</button>
            <button class="btn-nav" style="background:red" onclick="hardReset()">RESET</button>
        </div>
        <button class="btn-nav" style="width:100%; margin-top:8px; background:var(--gold); color:black" onclick="spinWheel()">DRAAI STELLING</button>
    </div>

    <div id="screen-1" class="screen active">
        <h1 style="font-family:'Black Ops One'; font-size:3rem; color:var(--gold);">SQUAD</h1>
        <div id="join-box" class="card">
            <input type="text" id="name-in" placeholder="TYP JE NAAM...">
            <button onclick="join()" class="btn">MISSIE STARTEN</button>
        </div>
        <div class="card" style="background:rgba(255,255,255,0.1); border:1px solid var(--neon);">
            <div id="lobby-list"></div>
        </div>
    </div>

    <div id="screen-2" class="screen">
        <h2 style="color:var(--gold)">LOCATIE: OLIJFBERG</h2>
        <div class="card" style="padding:0; height:400px; overflow:hidden;">
            <iframe width="100%" height="100%" frameborder="0" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3392.5115980650!2d35.2425!3d31.7772!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x1503299710892971%3A0x86e885145b080512!2sMount%20of%20Olives!5e0!3m2!1snl!2snl!4v1700000000000"></iframe>
        </div>
    </div>

    <div id="screen-3" class="screen">
        <div class="card">
            <div class="scroll-area">
<h3 style="color:var(--primary); margin:0;">Jezus bidt op de Olijfberg</h3>
Jezus ging de stad uit. Hij ging naar de Olijfberg, zoals altijd. De leerlingen gingen met hem mee. Toen ze op de berg waren, zei Jezus: ‚ÄòBid God om kracht, zodat je geen verkeerde keuze maakt.‚Äô

Daarna liep hij zelf een stukje verder. Hij knielde en begon te bidden: ‚ÄòVader, als u het wilt, houd dan dit zware lijden bij mij weg! Maar doe wat u zelf wilt, niet wat ik wil.‚Äô Toen kwam er een engel uit de hemel om Jezus kracht te geven. Jezus was bang en ging steeds harder bidden. Zijn zweet viel in grote druppels op de grond. Het leken wel druppels bloed.

Toen Jezus klaar was met bidden, stond Hij op en ging naar zijn leerlingen. Die waren van verdriet in slaap gevallen. Jezus zei: ‚ÄòWaarom slapen jullie? Bid God om kracht, zodat je geen verkeerde keuze maakt.‚Äô
(‚Ä¶)
<h3 style="color:var(--primary); margin:0;">Judas verraadt Jezus</h3>
Terwijl Jezus dat zei, kwam er een groep mannen aan. Judas, √©√©n van de twaalf leerlingen, liep voorop. Hij ging naar Jezus toe en groette hem met een kus. Maar Jezus zei: ‚ÄòJudas, verraad je de Mensenzoon met een kus?‚Äô

Toen de leerlingen begrepen wat er ging gebeuren, vroegen ze: ‚ÄòHeer, zullen we onze zwaarden pakken?‚Äô En √©√©n van de leerlingen pakte zijn zwaard en sloeg de knecht van de hogepriester. Hij sloeg zijn rechteroor eraf. Maar Jezus zei: ‚ÄòStop, genoeg!‚Äô En hij pakte het oor en maakte de man weer beter.

Er waren priesters, officieren van de tempel en leiders van het volk meegekomen om Jezus gevangen te nemen. Jezus zei tegen hen: ‚ÄòJullie zijn hier gekomen met zwaarden en stokken. Alsof ik een gevaarlijke misdadiger ben! Elke dag was ik bij jullie in de tempel, maar toen namen jullie mij niet gevangen. Nu is het moment gekomen waarop jullie gewacht hebben. Nu laat de duisternis haar macht zien.‚Äô
            </div>
        </div>
    </div>

    <div id="screen-4" class="screen">
        <div class="card">
            <h3 style="margin:0">Wie bad wat?</h3>
            <div id="name-pool" class="name-pool"></div>
            <div class="scroll-area" id="prayer-list" style="height:350px"></div>
        </div>
    </div>

    <div id="screen-5" class="screen">
        <div id="stelling-box" class="card" style="font-weight:bold; color:var(--primary); border:3px solid var(--neon);">...</div>
        <div class="card">
            <input type="text" id="msg-in" placeholder="Jouw mening...">
            <button onclick="sendMsg()" class="btn">POSTEN</button>
            <div id="live-feed" style="height: 150px; overflow-y: auto; background: #eee; border-radius: 10px; padding: 10px; display: flex; flex-direction: column-reverse; margin-top:10px;"></div>
        </div>
    </div>

    <div id="screen-6" class="screen">
        <div class="card">
            <h3>Woordzoeker</h3>
            <div id="ws-grid" style="display: grid; grid-template-columns: repeat(12, 1fr); gap: 2px; background: #333; padding: 5px; border-radius: 8px;"></div>
            <p id="ws-words" style="font-size:0.7rem; color:var(--primary); margin:10px 0;">GETHSEMANE ‚Ä¢ JUDAS ‚Ä¢ KRACHT ‚Ä¢ OLIJFBERG ‚Ä¢ GEBED</p>
            <input type="text" id="ws-sol" placeholder="WAT IS DE OPLOSSING?">
            <button onclick="checkWS()" class="btn">CHECK</button>
        </div>
    </div>

    <div id="screen-7" class="screen">
        <div id="maze-timer">30</div>
        <div id="maze-container">
            <div id="player" style="left:10px; top:10px;">üôè</div>
            <div id="guard1" class="soldier" style="left:200px; top:100px;">üíÇ</div>
            <div id="guard2" class="soldier" style="left:50px; top:200px;">üíÇ</div>
            <div class="wall" style="top:60px; left:0; width:220px; height:10px;"></div>
            <div class="wall" style="top:150px; left:80px; width:220px; height:10px;"></div>
            <div class="wall" style="top:230px; left:0; width:180px; height:10px;"></div>
            <div style="position:absolute; bottom:5px; right:5px; font-size:30px;">üèÅ</div>
        </div>
        <div style="display:grid; grid-template-columns:repeat(3,1fr); width:150px; margin:20px auto; gap:10px;">
            <button class="btn" style="grid-column:2" onclick="moveMaze(0,-20)">‚Üë</button>
            <button class="btn" onclick="moveMaze(-20,0)">‚Üê</button>
            <button class="btn" onclick="moveMaze(0,20)">‚Üì</button>
            <button class="btn" onclick="moveMaze(20,0)">‚Üí</button>
        </div>
    </div>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyBC3Dzm8PNPXw12VJNimvly5u2I93QeW54", databaseURL: "https://schatgravers15maart2026-default-rtdb.europe-west1.firebasedatabase.app", projectId: "schatgravers15maart2026" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let myName = "", isAdmin = false, pX=10, pY=10, timeLeft=30, mazeActive=false;

        function join() {
            const n = document.getElementById('name-in').value.trim();
            if(!n) return;
            myName = n; db.ref('players').push(n);
            document.getElementById('join-box').innerHTML = "<h3>Succes! Wacht op Dirkjaap...</h3>";
            if(n.toLowerCase() === 'dirkjaap') { isAdmin=true; document.getElementById('admin-panel').style.display='block'; }
            db.ref('currentStep').on('value', snap => {
                const step = snap.val() || 1;
                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                document.getElementById('screen-'+step).classList.add('active');
                if(step === 4) initPrayers();
                if(step === 6) initWS();
                if(step === 7) startMaze(); else stopMaze();
            });
        }

        function setStep(n) { if(isAdmin) db.ref('currentStep').set(n); }
        function hardReset() { if(confirm("ALLES RESETTEN?")) db.ref('/').set({currentStep:1, activeStelling:"Startklaar", chat:null}); }

        // GEBEDEN
        const prayers = [
            {n:"Abraham", p:"Ik bid dat er geen onschuldige mensen gedood worden."},
            {n:"Agur", p:"Ik bid om precies te krijgen wat ik nodig heb."},
            {n:"David", p:"Ik bid om vergeving omdat ik iemand vermoord heb."},
            {n:"Elia", p:"Ik bid dat God mij antwoord geeft."},
            {n:"Gideon", p:"Ik vraag God om een teken."},
            {n:"Hanna", p:"Ik bid om een zoon."},
            {n:"Jesaja", p:"Ik bid dat God vanuit de hemel naar ons kijkt."},
            {n:"Jezus", p:"Ik bid voor alle mensen die in mij zullen geloven."},
            {n:"Jezus", p:"Ik bid: ‚ÄòDoe wat U zelf wilt, niet wat ik wil‚Äô."},
            {n:"Jezus", p:"Ik bid: ‚ÄòVader, vergeef de mensen‚Äô."},
            {n:"Job", p:"Ik bid dat God aan mij denkt."},
            {n:"Mozes", p:"Ik probeer God op andere gedachten te brengen."},
            {n:"Nehemia", p:"Ik doe in stilte een schietgebedje om hulp."},
            {n:"Paulus", p:"Ik vraag aan anderen om voor mij te bidden."},
            {n:"Salomo", p:"Ik bid om het verschil tussen goed en kwaad."}
        ];
        function initPrayers() {
            const p = document.getElementById('name-pool'), l = document.getElementById('prayer-list');
            if(p.children.length > 0) return;
            [...prayers].sort(()=>Math.random()-0.5).forEach((o, i) => {
                const d = document.createElement('div'); d.className='drag-name'; d.innerText=o.n; d.draggable=true; d.id='n-'+i;
                d.ondragstart = (e) => e.dataTransfer.setData('text', e.target.id); p.appendChild(d);
            });
            prayers.forEach(o => {
                const r = document.createElement('div'); r.className='prayer-row';
                r.innerHTML = `<div class="drop-zone" data-ans="${o.n}"></div><div style="flex:1">${o.p}</div>`;
                l.appendChild(r);
            });
            document.querySelectorAll('.drop-zone').forEach(dz => {
                dz.ondragover = e => e.preventDefault();
                dz.ondrop = e => {
                    const el = document.getElementById(e.dataTransfer.getData('text'));
                    if(el.innerText === dz.dataset.ans) dz.appendChild(el);
                };
            });
        }

        // MAZE LOGIC
        function startMaze() {
            mazeActive = true; timeLeft = 30; pX=10; pY=10; updateMazePos();
            const timerInterval = setInterval(() => {
                if(!mazeActive) { clearInterval(timerInterval); return; }
                timeLeft--;
                document.getElementById('maze-timer').innerText = timeLeft;
                moveSoldiers();
                if(timeLeft <= 0) { alert("TIJD OP! Je bent gevangen!"); startMaze(); }
            }, 1000);
        }
        function stopMaze() { mazeActive = false; }
        function moveMaze(dx, dy) {
            if(!mazeActive) return;
            let nX = pX + dx, nY = pY + dy;
            if(nX < 0 || nX > 270 || nY < 0 || nY > 270) return;
            
            // Check muren
            let hitWall = false;
            document.querySelectorAll('.wall').forEach(w => {
                const wr = w.getBoundingClientRect();
                const pr = {left: nX, top: nY, right: nX+30, bottom: nY+30};
                // Simpele collision check
                if(nX < (parseInt(w.style.left)+parseInt(w.style.width)) && (nX+30) > parseInt(w.style.left) && 
                   nY < (parseInt(w.style.top)+parseInt(w.style.height)) && (nY+30) > parseInt(w.style.top)) {
                    hitWall = true;
                }
            });
            
            if(!hitWall) { pX = nX; pY = nY; updateMazePos(); }
            if(pX > 240 && pY > 240) { alert("ONTSNAPT!"); stopMaze(); }
        }
        function updateMazePos() {
            const p = document.getElementById('player'); p.style.left=pX+'px'; p.style.top=pY+'px';
        }
        function moveSoldiers() {
            ['guard1', 'guard2'].forEach(id => {
                const g = document.getElementById(id);
                const rX = Math.floor(Math.random()*250), rY = Math.floor(Math.random()*250);
                g.style.left = rX+'px'; g.style.top = rY+'px';
                // Check collision met speler
                setTimeout(() => {
                    const gx = parseInt(g.style.left), gy = parseInt(g.style.top);
                    if(Math.abs(gx-pX) < 25 && Math.abs(gy-pY) < 25) { alert("GEPAKT DOOR DE SOLDATEN!"); startMaze(); }
                }, 500);
            });
        }

        // STELLINGEN
        const stellingen = ["1 Ik ben nooit bang.", "2 Bij spanning hoop ik dat het niet doorgaat.", "3 Ik help anderen die het moeilijk hebben.", "4 Bij angst ga ik bidden.", "5 Ik heb de kracht van God gevoeld.", "6 Ik wil weten wat God wil."];
        function spinWheel() { db.ref('activeStelling').set(stellingen[Math.floor(Math.random()*6)]); }
        db.ref('activeStelling').on('value', snap => { if(document.getElementById('stelling-box')) document.getElementById('stelling-box').innerText = snap.val(); });
        function sendMsg() { const t = document.getElementById('msg-in').value; if(t) { db.ref('chat').push({n:myName, t:t}); document.getElementById('msg-in').value=""; } }
        db.ref('chat').limitToLast(10).on('value', snap => {
            const f = document.getElementById('live-feed'); if(!f) return;
            f.innerHTML = ""; snap.forEach(c => f.innerHTML += `<div class="feed-item"><b>${c.val().n}:</b> ${c.val().t}</div>`);
        });

        // WOORDZOEKER
        function initWS() {
            const g = document.getElementById('ws-grid'); if(g.children.length > 0) return;
            let letters = Array(144).fill(''); const sol = "GODGEEFTKRACHT".split(''); let sIdx = 0;
            for(let i=0; i<144; i++) {
                if(i % 11 === 0 && sIdx < sol.length) letters[i] = sol[sIdx++];
                else letters[i] = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*26)];
            }
            letters.forEach(l => {
                const d = document.createElement('div'); d.className='ws-letter'; d.innerText=l;
                d.style.cssText = "background:white; aspect-ratio:1; display:flex; align-items:center; justify-content:center; font-weight:bold; cursor:pointer;";
                d.onclick = () => d.style.background = d.style.background === 'red' ? 'white' : 'red';
                g.appendChild(d);
            });
        }
        function checkWS() { if(document.getElementById('ws-sol').value.toUpperCase().replace(/\s/g,'') === "GODGEEFTKRACHT") alert("GOED ZO!"); }

        db.ref('players').on('value', snap => {
            const l = document.getElementById('lobby-list'); l.innerHTML = "";
            if(snap.exists()) Object.values(snap.val()).forEach(v => l.innerHTML += `<span style="background:var(--neon); color:black; padding:4px 8px; border-radius:8px; margin:2px; font-size:0.7rem; font-weight:bold;">${v}</span>`);
        });
    </script>
</body>
</html>
