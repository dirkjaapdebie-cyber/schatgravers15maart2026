<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schatgravers - De Olijfberg Live</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1e3799; --accent: #ff7675; --success: #20bf6b;
            --white: rgba(255, 255, 255, 0.95); --gold: #f1c40f;
        }

        body, html { margin: 0; padding: 0; height: 100vh; font-family: 'Fredoka', sans-serif; overflow: hidden; background: #0a3d62; }
        
        .bg-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('schatgravers15maart.jpg'); background-size: cover; background-position: center;
            filter: blur(10px) brightness(0.3); z-index: -2;
        }

        /* SYNC INTRO PANEEL */
        #intro-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 100; display: none; 
            justify-content: center; align-items: center; padding: 20px;
        }

        .intro-card {
            background: white; width: 95%; max-width: 1100px; height: 90vh;
            border-radius: 40px; display: flex; overflow: hidden; box-shadow: 0 30px 60px rgba(0,0,0,0.5);
        }

        .intro-text { flex: 1.2; padding: 40px; overflow-y: auto; line-height: 1.6; color: #2d3436; }
        .intro-media { flex: 0.8; background: #dfe6e9; display: flex; flex-direction: column; }
        
        .olijfberg-img { height: 50%; background-image: url('https://images.unsplash.com/photo-1549102011-8276f70f6128?q=80&w=1000&auto=format&fit=crop'); background-size: cover; background-position: center; }
        
        .earth-link { 
            flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; 
            background: #1e3799; color: white; text-decoration: none; text-align: center; padding: 20px;
        }

        /* DASHBOARD */
        .main-stage { display: flex; flex: 1; padding: 25px; gap: 25px; height: 85vh; margin-top: 10px; }
        .dice-zone { width: 350px; background: var(--white); border-radius: 40px; padding: 30px; display: flex; flex-direction: column; align-items: center; box-shadow: 0 25px 50px rgba(0,0,0,0.5); }
        
        .scene { width: 100px; height: 100px; perspective: 600px; margin: 30px; }
        .cube { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .cube__face { position: absolute; width: 100px; height: 100px; background: white; border: 4px solid var(--primary); line-height: 100px; font-size: 40px; border-radius: 20px; text-align: center; color: var(--primary); font-weight: bold; }
        .cube__face--1 { transform: rotateY(0deg) translateZ(50px); }
        .cube__face--2 { transform: rotateY(180deg) translateZ(50px); }
        .cube__face--3 { transform: rotateY(-90deg) translateZ(50px); }
        .cube__face--4 { transform: rotateY(90deg) translateZ(50px); }
        .cube__face--5 { transform: rotateX(-90deg) translateZ(50px); }
        .cube__face--6 { transform: rotateX(90deg) translateZ(50px); }

        .btn-main { width: 100%; padding: 15px; border-radius: 30px; border: none; color: white; font-weight: bold; cursor: pointer; margin-bottom: 10px; font-family: 'Fredoka'; }
        .btn-roll { background: var(--primary); box-shadow: 0 5px 0 #0a3d62; }
        .btn-send { background: var(--success); box-shadow: 0 5px 0 #1b8d50; }
        .btn-reset { position: fixed; bottom: 10px; right: 10px; background: var(--accent); color: white; border: none; padding: 8px 15px; border-radius: 12px; cursor: pointer; z-index: 50; }

        .thought-cloud { flex: 1; display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; overflow-y: auto; padding: 10px; align-content: start; }
        .bubble { background: white; padding: 20px; border-radius: 25px 25px 25px 5px; box-shadow: 0 10px 20px rgba(0,0,0,0.2); animation: float 4s ease-in-out infinite; font-size: 1.1rem; }
        
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
    </style>
</head>
<body>

<div id="intro-overlay">
    <div class="intro-card">
        <div class="intro-text">
            <h1 style="color:var(--primary); margin-top:0;">Jezus op de Olijfberg</h1>
            <p><strong>De Olijfberg:</strong> Jezus ging naar de berg om te bidden. Hij vroeg zijn leerlingen om te waken, maar zij vielen in slaap van verdriet.</p>
            <p>Jezus was bang en bad om kracht. Een engel kwam Hem helpen. Daarna werd Hij verraden door Judas met een kus. Zelfs in die moeilijke tijd genas Jezus nog een vijand.</p>
            <hr>
            <p><em>Klik hieronder om de interactieve verwerking voor de hele klas te starten.</em></p>
            <button onclick="masterStart()" class="btn-main btn-roll" style="margin-top:20px; font-size:1.2rem;">START VERWERKING VOOR IEDEREEN ‚ú®</button>
        </div>
        <div class="intro-media">
            <div class="olijfberg-img"></div>
            <a href="https://earth.google.com/web/search/Mount+of+Olives,+Jerusalem/@31.7770,35.2444,800a,815d,35y,0h,0t,0r" target="_blank" class="earth-link">
                <span style="font-size:3rem">üåç</span>
                <h3>Bekijk de Olijfberg</h3>
                <p>Klik voor Google Earth</p>
            </a>
        </div>
    </div>
</div>

<div class="bg-overlay"></div>

<div class="main-stage">
    <div class="dice-zone">
        <div class="scene">
            <div class="cube" id="cube">
                <div class="cube__face cube__face--1">1</div>
                <div class="cube__face cube__face--2">2</div>
                <div class="cube__face cube__face--3">3</div>
                <div class="cube__face cube__face--4">4</div>
                <div class="cube__face cube__face--5">5</div>
                <div class="cube__face cube__face--6">6</div>
            </div>
        </div>
        <button class="btn-main btn-roll" onclick="triggerRoll()">GOOI DOBBELSTEEN</button>
        <div id="active-stmt" style="text-align:center; font-weight:600; color: var(--primary); margin-bottom: 20px; min-height: 80px; font-size: 1.1rem; line-height: 1.3;">Wacht op de start van de meester...</div>
        
        <input type="text" id="thought-in" placeholder="Jouw antwoord..." style="width: 100%; padding: 15px; border-radius: 20px; border: 1px solid #ddd; margin-bottom: 10px; box-sizing: border-box; font-family: 'Fredoka';">
        <button class="btn-main btn-send" onclick="sendThought()">DEEL JE GEDACHTE ‚ú®</button>
    </div>
    <div class="thought-cloud" id="live-thoughts"></div>
</div>

<button class="btn-reset" onclick="hardReset()">DATABASE RESET</button>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, onValue, push, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBC3Dzm8PNPXw12VJNimvly5u2I93QeW54",
        authDomain: "schatgravers15maart2026.firebaseapp.com",
        projectId: "schatgravers15maart2026",
        databaseURL: "https://schatgravers15maart2026-default-rtdb.europe-west1.firebasedatabase.app",
        storageBucket: "schatgravers15maart2026.firebasestorage.app",
        messagingSenderId: "30561512857",
        appId: "1:30561512857:web:fcb7868b87d292d1c97708"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // OLIJFBERG STELLINGEN
    const stellingen = [
        "ANGST: Wanneer ben jij wel eens heel erg bang (net als Jezus)?",
        "KEUZES: Vind je het moeilijk om de juiste keuze te maken als anderen iets anders doen?",
        "ENGELEN: Heb jij wel eens hulp gekregen van iemand op een moment dat je het echt nodig had?",
        "BIDDEN: Hoe praat jij met God als je het even niet meer weet?",
        "ALLEEN: Voel je je wel eens alleen gelaten door vrienden, zoals Jezus door de leerlingen?",
        "HERSTEL: Jezus maakte het oor van zijn vijand beter. Hoe kun jij iets wat kapot is weer goed maken?"
    ];

    window.masterStart = () => set(ref(db, 'phase'), 'started');

    window.triggerRoll = () => {
        const r = Math.floor(Math.random()*6)+1;
        set(ref(db, 'gameState'), {r, t: Date.now()});
    };

    window.sendThought = () => {
        const val = document.getElementById('thought-in').value;
        if(val) { push(ref(db, 'live'), val); document.getElementById('thought-in').value = ''; }
    };

    window.hardReset = () => {
        if(confirm("Alles wissen?")) {
            set(ref(db, 'phase'), 'intro');
            remove(ref(db, 'live'));
        }
    };

    // REAL-TIME SYNC
    onValue(ref(db, 'phase'), s => {
        document.getElementById('intro-overlay').style.display = (s.val() === 'started') ? 'none' : 'flex';
    });

    onValue(ref(db, 'gameState'), s => {
        const d = s.val(); if(d) {
            const cube = document.getElementById('cube');
            const rotations = {1:'rotateY(0deg)', 2:'rotateY(180deg)', 3:'rotateY(-90deg)', 4:'rotateY(90deg)', 5:'rotateX(-90deg)', 6:'rotateX(90deg)'};
            cube.style.transform = rotations[d.r];
            document.getElementById('active-stmt').innerText = stellingen[d.r-1];
        }
    });

    onValue(ref(db, 'live'), s => {
        const grid = document.getElementById('live-thoughts'); grid.innerHTML = "";
        const data = s.val(); if(data) Object.values(data).forEach(t => {
            const b = document.createElement('div'); b.className = 'bubble'; b.innerText = t; grid.appendChild(b);
        });
    });
</script>
</body>
</html>
