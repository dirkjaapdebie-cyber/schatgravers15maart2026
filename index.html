<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schatgravers Live - Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6c5ce7; --secondary: #a29bfe; --accent: #ff7675;
            --success: #55efc4; --danger: #ff4757; --bg: #f0f3f7; --white: #ffffff;
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background: radial-gradient(circle at center, #ffffff 0%, #dfe6e9 100%);
            margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden;
        }

        /* HEADER: Namen verzamelen */
        .names-bar {
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px);
            padding: 15px 25px; border-bottom: 4px solid var(--secondary);
            display: flex; align-items: center; gap: 20px; z-index: 10;
        }

        .name-tag {
            background: var(--primary); color: white; padding: 8px 18px;
            border-radius: 50px; font-weight: 600; box-shadow: 0 4px 0 #4834d4;
            animation: bounceIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            white-space: nowrap;
        }

        /* MIDDEN: Speelveld */
        .main-stage {
            display: flex; flex: 1; padding: 25px; gap: 25px; overflow: hidden;
        }

        .dice-zone {
            width: 350px; background: var(--white); border-radius: 40px;
            padding: 25px; display: flex; flex-direction: column; align-items: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1); border: 3px solid var(--secondary);
        }

        .scene { width: 100px; height: 100px; perspective: 600px; margin: 20px; cursor: pointer; }
        .cube { 
            width: 100%; height: 100%; position: relative; transform-style: preserve-3d; 
            transition: transform 1.5s cubic-bezier(0.2, 0.8, 0.3, 1.1); 
        }
        .cube__face { 
            position: absolute; width: 100px; height: 100px; background: white; 
            border: 4px solid var(--primary); line-height: 100px; font-size: 40px; 
            border-radius: 20px; text-align: center; color: var(--primary); font-weight: bold;
        }
        .cube__face--1 { transform: rotateY(0deg) translateZ(50px); }
        .cube__face--2 { transform: rotateY(180deg) translateZ(50px); }
        .cube__face--3 { transform: rotateY(-90deg) translateZ(50px); }
        .cube__face--4 { transform: rotateY(90deg) translateZ(50px); }
        .cube__face--5 { transform: rotateX(-90deg) translateZ(50px); }
        .cube__face--6 { transform: rotateX(90deg) translateZ(50px); }

        .thought-cloud {
            flex: 1; background: rgba(255, 255, 255, 0.4); border-radius: 40px;
            padding: 30px; border: 4px dashed var(--secondary);
            display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px; overflow-y: auto; align-content: start;
        }

        .bubble {
            background: white; padding: 20px; border-radius: 30px 30px 30px 5px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.05); animation: float 3s ease-in-out infinite;
        }

        /* ONDER: 6 Schatkamers */
        .treasure-vaults {
            height: 30%; display: grid; grid-template-columns: repeat(6, 1fr);
            gap: 15px; padding: 15px 25px; background: var(--secondary); position: relative;
        }

        .vault {
            background: rgba(255, 255, 255, 0.9); border-radius: 20px; padding: 10px;
            display: flex; flex-direction: column; overflow-y: auto;
        }

        .vault h4 { margin: 0 0 8px 0; font-size: 0.8rem; color: var(--primary); text-align: center; }

        /* Knoppen & Input */
        input { 
            width: 100%; padding: 12px 20px; border-radius: 25px; border: 2px solid #eee; 
            font-family: inherit; margin-bottom: 10px; outline: none; box-sizing: border-box;
        }
        .btn {
            width: 100%; padding: 12px; border-radius: 25px; border: none; 
            color: white; font-weight: bold; font-family: inherit; cursor: pointer; transition: 0.2s;
        }
        .btn-roll { background: var(--primary); box-shadow: 0 4px 0 #4834d4; margin-bottom: 10px; }
        .btn-send { background: var(--success); box-shadow: 0 4px 0 #00b894; }
        
        /* De Grote Reset Knop */
        .btn-reset {
            position: absolute; bottom: 10px; right: 10px; width: auto;
            background: var(--danger); font-size: 0.7rem; padding: 5px 15px;
            box-shadow: 0 3px 0 #c0392b; opacity: 0.7;
        }
        .btn-reset:hover { opacity: 1; }

        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-10px); } }
        @keyframes bounceIn { 0% { transform: scale(0); } 70% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

<div class="names-bar">
    <div style="display: flex; gap: 10px;">
        <input type="text" id="name-in" placeholder="Wie ben je?" style="width: 150px; margin:0">
        <button onclick="sendName()" class="btn" style="width: auto; background: var(--success); box-shadow: 0 4px 0 #00b894;">Ik ben er!</button>
    </div>
    <div class="name-container" id="names-display" style="display: flex; gap: 10px; overflow-x: auto; flex-grow: 1;"></div>
</div>

<div class="main-stage">
    <div class="dice-zone">
        <div class="scene" onclick="triggerRoll()">
            <div class="cube" id="cube">
                <div class="cube__face cube__face--1">1</div>
                <div class="cube__face cube__face--2">2</div>
                <div class="cube__face cube__face--3">3</div>
                <div class="cube__face cube__face--4">4</div>
                <div class="cube__face cube__face--5">5</div>
                <div class="cube__face cube__face--6">6</div>
            </div>
        </div>
        <button class="btn btn-roll" onclick="triggerRoll()">GOOI DOBBELSTEEN</button>
        <div id="active-statement" style="text-align:center; font-weight:600; color: var(--primary); margin-bottom: 15px; height: 45px; display: flex; align-items: center; justify-content: center;">Klik op gooi!</div>
        <input type="text" id="thought-in" placeholder="Jouw gedachte...">
        <button class="btn btn-send" onclick="sendThought()">DEEL JE SCHAT ✨</button>
    </div>

    <div class="thought-cloud" id="live-thoughts"></div>
</div>

<div class="treasure-vaults">
    <div class="vault" id="v1"><h4>❶ Bang</h4><div id="c1"></div></div>
    <div class="vault" id="v2"><h4>❷ Spannend</h4><div id="c2"></div></div>
    <div class="vault" id="v3"><h4>❸ Helpen</h4><div id="c3"></div></div>
    <div class="vault" id="v4"><h4>❹ Bidden</h4><div id="c4"></div></div>
    <div class="vault" id="v5"><h4>❺ Kracht</h4><div id="c5"></div></div>
    <div class="vault" id="v6"><h4>❻ God's Wil</h4><div id="c6"></div></div>
    
    <button class="btn btn-reset" onclick="hardReset()">HARDE RESET (WISSEN)</button>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, onValue, push, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyBC3Dzm8PNPXw12VJNimvly5u2I93QeW54",
        authDomain: "schatgravers15maart2026.firebaseapp.com",
        projectId: "schatgravers15maart2026",
        databaseURL: "https://schatgravers15maart2026-default-rtdb.europe-west1.firebasedatabase.app",
        storageBucket: "schatgravers15maart2026.firebasestorage.app",
        messagingSenderId: "30561512857",
        appId: "1:30561512857:web:fcb7868b87d292d1c97708"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    let currentRollNum = 0;
    const stellingen = ["Ik ben nooit bang.", "Als ik iets spannend vind, hoop ik dat het niet doorgaat.", "Als iemand het moeilijk heeft, help ik.", "Als ik bang ben, ga ik bidden.", "Ik heb kracht van God gevoeld.", "Ik wil meer weten over wat God wil."];

    // FUNCTIES
    window.sendName = () => {
        const val = document.getElementById('name-in').value;
        if(val) { push(ref(db, 'names'), val); document.getElementById('name-in').value = ''; }
    };

    window.triggerRoll = () => {
        if(currentRollNum > 0) {
            onValue(ref(db, 'live'), snap => {
                const d = snap.val(); if(d) Object.values(d).forEach(t => push(ref(db, `vault/v${currentRollNum}`), t));
            }, {onlyOnce: true});
        }
        remove(ref(db, 'live'));
        const r = Math.floor(Math.random()*6)+1;
        set(ref(db, 'gameState'), {r, t: Date.now()});
    };

    window.sendThought = () => {
        const val = document.getElementById('thought-in').value;
        if(val && currentRollNum > 0) { push(ref(db, 'live'), val); document.getElementById('thought-in').value = ''; }
    };

    // DE HARDE RESET
    window.hardReset = () => {
        if(confirm("Weet je het zeker? Dit wist alle namen en alle verzamelde teksten van deze sessie!")) {
            remove(ref(db, '/')); // Wist ALLES in de database
            location.reload();    // Herlaad de pagina
        }
    };

    // REALTIME SYNC
    onValue(ref(db, 'names'), s => {
        const div = document.getElementById('names-display'); div.innerHTML = "";
        const data = s.val(); if(data) Object.values(data).forEach(n => {
            const span = document.createElement('span'); span.className = 'name-tag'; span.innerText = n; div.appendChild(span);
        });
    });

    onValue(ref(db, 'gameState'), s => {
        const d = s.val(); if(d) {
            currentRollNum = d.r;
            const cube = document.getElementById('cube');
            const rotations = {1:'rotateY(0deg)', 2:'rotateY(180deg)', 3:'rotateY(-90deg)', 4:'rotateY(90deg)', 5:'rotateX(-90deg)', 6:'rotateX(90deg)'};
            cube.style.transform = rotations[d.r];
            document.getElementById('active-statement').innerText = stellingen[d.r-1];
        }
    });

    onValue(ref(db, 'live'), s => {
        const grid = document.getElementById('live-thoughts'); grid.innerHTML = "";
        const data = s.val(); if(data) Object.values(data).forEach(t => {
            const b = document.createElement('div'); b.className = 'bubble'; b.innerText = t; grid.appendChild(b);
        });
    });

    for(let i=1; i<=6; i++) {
        onValue(ref(db, `vault/v${i}`), s => {
            const cont = document.getElementById(`c${i}`); cont.innerHTML = "";
            const data = s.val(); if(data) Object.values(data).forEach(t => {
                const m = document.createElement('div'); m.style = "font-size:0.7rem; background:#f1f2f6; margin:3px; padding:5px; border-radius:10px;"; m.innerText = t; cont.appendChild(m);
            });
        });
    }
</script>
</body>
</html>
